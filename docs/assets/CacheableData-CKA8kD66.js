import{r as e}from"./index-DyFhm7NF.js";import{u as E}from"./SearchSyncToolbar-BD-kT8Me.js";const q=(o,g={})=>{const{defaultValue:p,loadOnMount:u=!0,revalidationKey:f,resetStateOnRevalidation:i=!1,autoSync:d=!0}=g,n=e.useRef(!0),a=e.useRef(o);a.current=o;const t=e.useRef(null),{load:R,loading:m,errorMessage:v,record:y,setRecord:s,reset:c,...C}=E(p,u),r=e.useCallback(()=>R(async()=>{if(a.current)return t.current&&(t.current.cancelRequest(),t.current=null),a.current({getRequestController:l=>{t.current=l},getStaleWhileRevalidate:l=>{s(l)}}).finally(()=>{t.current=null})}),[R,s]);return e.useEffect(()=>{u&&n.current&&r()},[r,u]),e.useEffect(()=>{!n.current&&f&&(i&&c(),d&&r())},[d,r,c,i,f]),e.useEffect(()=>(n.current=!1,()=>{n.current=!0}),[]),{load:r,loading:m,errorMessage:v,data:y,setData:s,reset:c,...C}};export{q as u};
