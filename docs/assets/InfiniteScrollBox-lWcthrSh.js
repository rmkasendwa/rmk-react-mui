import{j as v}from"./jsx-runtime-DoEZbXM1.js";import{c as V,e as Z,g as $,f as F}from"./defaultTheme-p7chgXuo.js";import{r as t}from"./index-DyFhm7NF.js";import{o as P}from"./index-Bf2qc8Rt.js";import{u as m}from"./useThemeProps-Bd4KMueQ.js";import{B as E}from"./Box-Cv6nAA57.js";const L=80,rr=({elementRef:c,element:a,bottomThreshold:f=L,load:D,onChangeScrollLength:S,changeEventCallbackTimeout:M=0,shouldLoadOnScroll:k=!0,invertScrollDirection:C=!1,dataElementLength:s,paging:O=!1,dataElements:e,onSelectDataElement:j,onClose:A,focusedElementIndex:h,onChangeFocusedDataElement:I,enableKeyboardNavigationWrapping:U=!1,keyboardFocusElement:l,orientation:N="vertical",revalidationKey:q})=>{const H=t.useRef(!0),u=t.useRef(D);u.current=D;const x=t.useRef(S);x.current=S;const _=t.useRef(void 0),y=t.useRef(I);y.current=I;const T=t.useRef(j);T.current=j;const b=t.useRef(A);b.current=A;const z=Math.max(25,(()=>{const r=a??(c==null?void 0:c.current);return r!=null&&r.offsetHeight&&s?Math.ceil(r.offsetHeight/s):s??0})()),[w,d]=t.useState(0),[g,B]=t.useState(h);t.useEffect(()=>{h!=null&&B(h)},[h]),t.useEffect(()=>{!H.current&&g!=null&&y.current&&y.current(g)},[g]),t.useEffect(()=>{const r=[];l&&(Array.isArray(l)?r.push(...l):r.push(l));const i=a??(c==null?void 0:c.current);if(i&&r.push(i),e&&s&&r.length>0){const p=n=>{B((o=-1)=>{const X=(()=>{switch(n.key){case"ArrowUp":return n.preventDefault(),U||!u.current||o>0?(o||e.length)-1:0;case"ArrowDown":return n.preventDefault(),(o+1)%e.length;case"Enter":case"Tab":o!=null&&T.current&&(n.preventDefault(),T.current(o));break;case"Escape":b.current&&(n.preventDefault(),b.current());break}})();if(X!=null&&(i!=null&&i.offsetHeight)&&i){const W=X*s,{scrollTop:Y}=i,G=Y+i.offsetHeight;return W+s>G&&(i.scrollTop=Y+W+s-G),W<Y&&(i.scrollTop=W),X}return o>=0?o:0})};return r.forEach(n=>{n.addEventListener("keydown",p)}),()=>{r.forEach(n=>{n.removeEventListener("keydown",p)})}}},[s,e,a,c,U,l]),t.useEffect(()=>{const r=a??(c==null?void 0:c.current);if(r&&k){const i=()=>{const p=Math.abs(r.scrollTop),n=Math.abs(r.scrollLeft);switch(N){case"vertical":{const o=C?p<f:Math.abs(p+r.offsetHeight-r.scrollHeight)<f;r.scrollHeight>r.offsetHeight&&o&&u.current&&u.current()}break;case"horizontal":{const o=C?n<f:Math.abs(n+r.offsetWidth-r.scrollWidth)<f;r.scrollWidth>r.offsetWidth&&o&&u.current&&u.current()}break}clearTimeout(_.current),_.current=setTimeout(()=>{var o;(o=x.current)==null||o.call(x,{scrollTop:p,scrollLeft:n})},M),s&&d(Math.floor(p/s))};return r.addEventListener("scroll",i),i(),()=>{r.removeEventListener("scroll",i)}}},[f,M,s,a,c,C,N,q,k]),t.useEffect(()=>(H.current=!1,()=>{H.current=!0}),[]);const R=(()=>{if(e)return O?e.slice(w,w+z):e})(),K=(()=>{if(O&&s&&e)return e.length*s})(),Q=(()=>{if(s)return w*s})();return{dataElementsContainerHeight:K,dataElementsContainerFillerElementHeight:Q,displayableDataSet:R}},sr=c=>$("MuiInfiniteScrollBox",c),J={root:["root"]};F("MuiInfiniteScrollBox",Object.keys(J));const tr=t.forwardRef(function(a,f){const D=m({props:a,name:"MuiInfiniteScrollBox"}),{className:S,bottomThreshold:M,load:k,shouldLoadOnScroll:C,invertScrollDirection:s,onChangeScrollLength:O,dataElementLength:e,children:j,paging:A,dataElements:h,onSelectDataElement:I,onClose:U,focusedElementIndex:l,onChangeFocusedDataElement:N,enableKeyboardNavigationWrapping:q,keyboardFocusElement:H,PagingContainer:u={},...x}=D,_=V(J,sr,(()=>{if(S)return{root:S}})()),{sx:y,...T}=u,[b,z]=t.useState(null),{dataElementsContainerHeight:w,dataElementsContainerFillerElementHeight:d,displayableDataSet:g}=rr({bottomThreshold:M,load:k,shouldLoadOnScroll:C,invertScrollDirection:s,paging:A,dataElements:h,onSelectDataElement:I,onClose:U,focusedElementIndex:l,onChangeFocusedDataElement:N,enableKeyboardNavigationWrapping:q,keyboardFocusElement:H,dataElementLength:e,onChangeScrollLength:O,element:b});return v.jsx(E,{ref:P([f,B=>z(B)]),...x,className:Z(_.root),tabIndex:0,children:g?v.jsxs(E,{...T,sx:{...y,minHeight:w},children:[d?v.jsx(E,{sx:{height:d}}):null,g.map((B,R)=>v.jsx(t.Fragment,{children:B},R))]}):j})});tr.__docgenInfo={description:"",methods:[],displayName:"InfiniteScrollBox",props:{PagingContainer:{required:!1,tsType:{name:"Partial",elements:[{name:"BoxProps"}],raw:"Partial<BoxProps>"},description:""}},composes:["Partial","Omit"]};export{tr as I,rr as u};
