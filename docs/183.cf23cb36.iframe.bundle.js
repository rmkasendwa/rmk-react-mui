"use strict";(self.webpackChunk_infinite_debugger_react_mui=self.webpackChunk_infinite_debugger_react_mui||[]).push([[183],{"./src/components/ImageSelector.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{ZP:function(){return components_ImageSelector}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),CameraAlt=__webpack_require__("./node_modules/@mui/icons-material/CameraAlt.js"),Close=__webpack_require__("./node_modules/@mui/icons-material/Close.js"),Replay=__webpack_require__("./node_modules/@mui/icons-material/Replay.js"),generateUtilityClass=__webpack_require__("./node_modules/@mui/utils/esm/generateUtilityClass/generateUtilityClass.js"),generateUtilityClasses=__webpack_require__("./node_modules/@mui/utils/esm/generateUtilityClasses/generateUtilityClasses.js"),useThemeProps=__webpack_require__("./node_modules/@mui/material/esm/styles/useThemeProps.js"),composeClasses=__webpack_require__("./node_modules/@mui/utils/esm/composeClasses/composeClasses.js"),Avatar=__webpack_require__("./node_modules/@mui/material/esm/Avatar/Avatar.js"),Box=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),Button=__webpack_require__("./node_modules/@mui/material/esm/Button/Button.js"),Card=__webpack_require__("./node_modules/@mui/material/esm/Card/Card.js"),FormControl=__webpack_require__("./node_modules/@mui/material/esm/FormControl/FormControl.js"),FormHelperText=__webpack_require__("./node_modules/@mui/material/esm/FormHelperText/FormHelperText.js"),Grid=__webpack_require__("./node_modules/@mui/material/esm/Grid/Grid.js"),IconButton=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),useTheme=__webpack_require__("./node_modules/@mui/material/styles/useTheme.js"),Typography=__webpack_require__("./node_modules/@mui/material/esm/Typography/Typography.js"),colorManipulator=__webpack_require__("./node_modules/@mui/system/colorManipulator.js"),clsx_m=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),react=__webpack_require__("./node_modules/react/index.js"),Files=__webpack_require__("./src/hooks/Files.ts"),page=__webpack_require__("./src/utils/page.ts"),Modal=__webpack_require__("./node_modules/@mui/material/esm/Modal/Modal.js"),dist=__webpack_require__("./node_modules/react-merge-refs/dist/index.mjs"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),_excluded=["className","imageSource","onClose"],getImagePreviewUtilityClass=function getImagePreviewUtilityClass(slot){return(0,generateUtilityClass.Z)("MuiImagePreview",slot)},slots={root:["root"]},ImagePreview=((0,generateUtilityClasses.Z)("MuiImagePreview",Object.keys(slots)),(0,react.forwardRef)((function ImagePreview(inProps,ref){var props=(0,useThemeProps.Z)({props:inProps,name:"MuiImagePreview"}),className=props.className,imageSource=props.imageSource,onClose=props.onClose,rest=(0,objectWithoutProperties.Z)(props,_excluded),classes=(0,composeClasses.Z)(slots,getImagePreviewUtilityClass,function(){if(className)return{root:className}}()),imageScaleRef=(0,react.useRef)(1),translationRef=(0,react.useRef)({x:0,y:0}),_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),image=_useState2[0],setImage=_useState2[1],_useState3=(0,react.useState)(!1),_useState4=(0,slicedToArray.Z)(_useState3,2),userTransformed=_useState4[0],setUserTransformed=_useState4[1],_useState5=(0,react.useState)(null),_useState6=(0,slicedToArray.Z)(_useState5,2),imagePreviewElement=_useState6[0],setImagePreviewElement=_useState6[1],_useTheme=(0,useTheme.Z)(),spacing=_useTheme.spacing,palette=_useTheme.palette,alphaBGColor=(0,colorManipulator.Fq)(palette.text.primary,.3),transformImagePreview=(0,react.useCallback)((function(){imagePreviewElement&&(imagePreviewElement.style.transform="translate(".concat(translationRef.current.x,"px, ").concat(translationRef.current.y,"px) scale(").concat(imageScaleRef.current,")"))}),[imagePreviewElement]);return(0,react.useEffect)((function(){imageSource&&(setImage(null),setUserTransformed(!1))}),[imageSource]),(0,react.useEffect)((function(){if(imageSource){var _image=new Image,adjustImageScale=function adjustImageScale(){if(!userTransformed){var _window=window,windowInnerWidth=_window.innerWidth,windowInnerHeight=_window.innerHeight,width=_image.width,height=_image.height,windowAspectRatio=windowInnerWidth/windowInnerHeight,imageAspectRatio=width/height;imageScaleRef.current=(scale=imageAspectRatio>windowAspectRatio?(windowInnerWidth-50)/width:(windowInnerHeight-50)/height)<1?scale:1,transformImagePreview()}var scale},windowResizeCallback=function windowResizeCallback(){return adjustImageScale()};return _image.onload=function(){adjustImageScale(),setImage(_image),translationRef.current={x:0,y:0}},_image.src=imageSource,window.addEventListener("resize",windowResizeCallback),function(){window.removeEventListener("resize",windowResizeCallback)}}}),[imageSource,transformImagePreview,userTransformed]),(0,react.useEffect)((function(){var mousewheelCallback=function mousewheelCallback(event){imageScaleRef.current=function(_event$wheelDelta){if((null!==(_event$wheelDelta=event.wheelDelta)&&void 0!==_event$wheelDelta?_event$wheelDelta:-event.detail)>0){var nextImageScale=imageScaleRef.current+.1;return nextImageScale>4?4:nextImageScale}var _nextImageScale=imageScaleRef.current-.1;return _nextImageScale<.25?.25:_nextImageScale}(),transformImagePreview(),setUserTransformed(!0)};return window.addEventListener("mousewheel",mousewheelCallback),function(){window.removeEventListener("mousewheel",mousewheelCallback)}}),[transformImagePreview]),(0,react.useEffect)((function(){if(imagePreviewElement){var mousemoveCallback,mousedownCallback=function mousedownCallback(event){var initalClientX=event.clientX,initalClientY=event.clientY;mousemoveCallback=function mousemoveCallback(event){var clientX=event.clientX,clientY=event.clientY,dX=clientX-initalClientX,dY=clientY-initalClientY,_translationRef$curre=translationRef.current,x=_translationRef$curre.x,y=_translationRef$curre.y;translationRef.current={x:x+dX,y:y+dY},initalClientX=clientX,initalClientY=clientY,transformImagePreview()},window.addEventListener("mousemove",mousemoveCallback)},mouseupCallback=function mouseupCallback(){window.removeEventListener("mousemove",mousemoveCallback)};return imagePreviewElement.addEventListener("mousedown",mousedownCallback),window.addEventListener("mouseup",mouseupCallback),function(){imagePreviewElement.removeEventListener("mousedown",mousedownCallback),window.removeEventListener("mouseup",mouseupCallback),window.removeEventListener("mousemove",mousemoveCallback)}}}),[imagePreviewElement,transformImagePreview]),(0,jsx_runtime.jsx)(Modal.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},rest),{},{onClose:onClose,ref:(0,dist.l)([ref,function(modal){modal&&Object.assign(modal.style,{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"})}])},rest),{},{className:(0,clsx_m.Z)(classes.root),children:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:function(){if(imageSource)return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Card.Z,{ref:function ref(imagePreviewElement){setImagePreviewElement(imagePreviewElement)},sx:{transform:"translate(".concat(translationRef.current.x,"px, ").concat(translationRef.current.y,"px) scale(").concat(imageScaleRef.current,")"),width:null==image?void 0:image.width,height:null==image?void 0:image.height,backgroundImage:"url(".concat(imageSource,")"),cursor:"move"}}),(0,jsx_runtime.jsx)(IconButton.Z,{onClick:function onClick(){null==onClose||onClose({},"backdropClick")},sx:{bgcolor:alphaBGColor,"&:hover":{bgcolor:alphaBGColor},color:palette.background.paper,position:"fixed",top:spacing(3),right:spacing(3)},children:(0,jsx_runtime.jsx)(Close.Z,{})})]})}()})}))}))),components_ImagePreview=ImagePreview;try{getImagePreviewUtilityClass.displayName="getImagePreviewUtilityClass",getImagePreviewUtilityClass.__docgenInfo={description:"",displayName:"getImagePreviewUtilityClass",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ImagePreview.tsx#getImagePreviewUtilityClass"]={docgenInfo:getImagePreviewUtilityClass.__docgenInfo,name:"getImagePreviewUtilityClass",path:"src/components/ImagePreview.tsx#getImagePreviewUtilityClass"})}catch(__react_docgen_typescript_loader_error){}try{ImagePreview.displayName="ImagePreview",ImagePreview.__docgenInfo={description:"",displayName:"ImagePreview",props:{sx:{defaultValue:null,description:"The system prop that allows defining system overrides as well as additional CSS styles.",name:"sx",required:!1,type:{name:"SxProps<Theme>"}},components:{defaultValue:{value:"{}"},description:"The components used for each slot inside the Modal.\nEither a string to use a HTML element or a component.",name:"components",required:!1,type:{name:"{ Root?: ElementType<any>; Backdrop?: ElementType<any>; } | undefined"}},componentsProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside the Modal.",name:"componentsProps",required:!1,type:{name:'{ root?: SlotComponentProps<"div", ModalUnstyledComponentsPropsOverrides, ModalUnstyledOwnerState>; backdrop?: SlotComponentProps<...>; } | undefined'}},BackdropComponent:{defaultValue:{value:"styled(Backdrop, {\nname: 'MuiModal',\nslot: 'Backdrop',\noverridesResolver: (props, styles) => {\nreturn styles.backdrop;\n},\n})({\nzIndex: -1,\n})"},description:"A backdrop component. This prop enables custom backdrop rendering.\n@deprecated Use `slots.backdrop` instead. While this prop currently works, it will be removed in the next major version.\nUse the `slots.backdrop` prop to make your application ready for the next version of Material UI.",name:"BackdropComponent",required:!1,type:{name:'ElementType<BackdropProps<"div", {}>>'}},BackdropProps:{defaultValue:null,description:"Props applied to the [`Backdrop`](/material-ui/api/backdrop/) element.\n@deprecated Use `slotProps.backdrop` instead.",name:"BackdropProps",required:!1,type:{name:'Partial<BackdropProps<"div", {}>>'}},imageSource:{defaultValue:null,description:"",name:"imageSource",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ImagePreview.tsx#ImagePreview"]={docgenInfo:ImagePreview.__docgenInfo,name:"ImagePreview",path:"src/components/ImagePreview.tsx#ImagePreview"})}catch(__react_docgen_typescript_loader_error){}var ImageSelector_excluded=["className","helperText","error","onChange","name","id","value","upload"],getImageSelectorUtilityClass=function getImageSelectorUtilityClass(slot){return(0,generateUtilityClass.Z)("MuiImageSelector",slot)},ImageSelector_slots={root:["root"]},ImageSelector=((0,generateUtilityClasses.Z)("MuiImageSelector",Object.keys(ImageSelector_slots)),(0,react.forwardRef)((function ImageSelector(inProps,ref){var props=(0,useThemeProps.Z)({props:inProps,name:"MuiImageSelector"}),className=props.className,helperText=props.helperText,error=props.error,onChange=props.onChange,name=props.name,id=props.id,value=props.value,upload=props.upload,rest=(0,objectWithoutProperties.Z)(props,ImageSelector_excluded),classes=(0,composeClasses.Z)(ImageSelector_slots,getImageSelectorUtilityClass,function(){if(className)return{root:className}}()),palette=(0,useTheme.Z)().palette,alphaBGColor=(0,colorManipulator.Fq)(palette.text.primary,.3),_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),imageThumbnailContainer=_useState2[0],setImageThumbnailContainer=_useState2[1],_useState3=(0,react.useState)(null),_useState4=(0,slicedToArray.Z)(_useState3,2),selectedImageFile=_useState4[0],setSelectedImageFile=_useState4[1],_useState5=(0,react.useState)(null),_useState6=(0,slicedToArray.Z)(_useState5,2),fileField=_useState6[0],setFileField=_useState6[1],_useFileUpload=(0,Files.F)({fileField:fileField,upload:upload,name:name,id:id,value:value,onChange:onChange}),images=_useFileUpload.files,setImages=_useFileUpload.setFiles,duplicateFileSelections=_useFileUpload.duplicateFileSelections;(0,react.useEffect)((function(){imageThumbnailContainer&&duplicateFileSelections.length>0&&(0,toConsumableArray.Z)(imageThumbnailContainer.querySelectorAll(".image-selector-thumbnail")).filter((function(_,index){return duplicateFileSelections.includes(index)})).forEach((function(thumbnail){return(0,page.N)(thumbnail)}))}),[duplicateFileSelections,imageThumbnailContainer]);var wrapperStyle={};return error&&(wrapperStyle.borderColor=palette.error.main),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(FormControl.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({ref:ref},rest),{},{className:(0,clsx_m.Z)(classes.root),fullWidth:!0,error:error,children:[(0,jsx_runtime.jsxs)(Card.Z,{sx:(0,objectSpread2.Z)({p:1.5,borderRadius:1,bgcolor:(0,colorManipulator._j)(palette.background.paper,.03),borderStyle:"dashed"},wrapperStyle),children:[(0,jsx_runtime.jsx)("input",{type:"file",ref:function ref(fileField){setFileField(fileField)},multiple:!0,accept:".jpg,.png,.jpeg,.bmp",style:{display:"none"}}),(0,jsx_runtime.jsxs)(Grid.ZP,{ref:function ref(imageThumbnailContainer){setImageThumbnailContainer(imageThumbnailContainer)},container:!0,spacing:1.5,children:[images.map((function(image,index){var base64=image.base64,url=image.url,uploading=image.uploading,uploadProgress=image.uploadProgress,uploadError=image.uploadError,cancelUpload=image.cancelUpload,retryUpload=image.retryUpload;return(0,jsx_runtime.jsx)(Grid.ZP,{item:!0,xs:4,sm:3,md:2,children:(0,jsx_runtime.jsxs)(Card.Z,{className:"image-selector-thumbnail",onClick:function onClick(){return setSelectedImageFile(image)},sx:{borderRadius:1,position:"relative",cursor:"zoom-in"},children:[(0,jsx_runtime.jsx)(Avatar.Z,{sx:{borderRadius:1,width:"100%",height:80,bgcolor:"#fff",opacity:uploading||uploadError?.3:1},src:base64||url}),(0,jsx_runtime.jsxs)(Box.Z,{sx:{position:"absolute",right:5,top:5,display:"flex",gap:"5px"},children:[(0,jsx_runtime.jsx)(IconButton.Z,{onClick:function onClick(event){event.stopPropagation(),function handleClickImageRemoveButton(index){setImages((function(prevImages){return prevImages.splice(index,1),(0,toConsumableArray.Z)(prevImages)}))}(index),cancelUpload&&cancelUpload()},size:"small",sx:{"&,&:hover":{bgcolor:alphaBGColor,color:palette.background.paper}},children:(0,jsx_runtime.jsx)(Close.Z,{sx:{fontSize:"12px"}})}),retryUpload&&(0,jsx_runtime.jsx)(IconButton.Z,{onClick:function onClick(event){event.stopPropagation(),retryUpload()},size:"small",sx:{"&,&:hover":{bgcolor:alphaBGColor,color:palette.background.paper}},children:(0,jsx_runtime.jsx)(Replay.Z,{sx:{fontSize:"12px"}})})]}),uploadProgress&&(uploading||uploadError)?(0,jsx_runtime.jsx)(Box.Z,{sx:{position:"absolute",height:3,borderRadius:"4px",width:"".concat(uploadProgress,"%"),bgcolor:uploadError?"#D04437":"#006BFF",bottom:0}}):null]})},index)})),(0,jsx_runtime.jsx)(Grid.ZP,{item:!0,xs:4,sm:3,md:2,children:(0,jsx_runtime.jsxs)(Button.Z,{onClick:function onClick(){null==fileField||fileField.click()},sx:{borderRadius:1,width:"100%",height:"80px !important",bgcolor:palette.background.paper,color:"#BABCC1",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",border:"none","&:hover":{bgcolor:palette.background.paper}},children:[(0,jsx_runtime.jsx)(CameraAlt.Z,{}),(0,jsx_runtime.jsx)(Typography.Z,{variant:"body2",sx:{fontSize:12,color:"#BABCC1"},children:"Add Photos"})]})})]})]}),helperText&&(0,jsx_runtime.jsx)(FormHelperText.Z,{children:helperText})]})),(0,jsx_runtime.jsx)(components_ImagePreview,{open:Boolean(selectedImageFile),onClose:function onClose(){return setSelectedImageFile(null)},imageSource:(null==selectedImageFile?void 0:selectedImageFile.base64)||(null==selectedImageFile?void 0:selectedImageFile.url)})]})}))),components_ImageSelector=ImageSelector;try{getImageSelectorUtilityClass.displayName="getImageSelectorUtilityClass",getImageSelectorUtilityClass.__docgenInfo={description:"",displayName:"getImageSelectorUtilityClass",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ImageSelector.tsx#getImageSelectorUtilityClass"]={docgenInfo:getImageSelectorUtilityClass.__docgenInfo,name:"getImageSelectorUtilityClass",path:"src/components/ImageSelector.tsx#getImageSelectorUtilityClass"})}catch(__react_docgen_typescript_loader_error){}try{ImageSelector.displayName="ImageSelector",ImageSelector.__docgenInfo={description:"",displayName:"ImageSelector",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"FileContainer[]"}},upload:{defaultValue:null,description:"",name:"upload",required:!1,type:{name:"FileUploadFunction"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ImageSelector.tsx#ImageSelector"]={docgenInfo:ImageSelector.__docgenInfo,name:"ImageSelector",path:"src/components/ImageSelector.tsx#ImageSelector"})}catch(__react_docgen_typescript_loader_error){}},"./src/hooks/Files.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{F:function(){return useFileUpload}});var D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),uniqid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/uniqid/index.js"),uniqid__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(uniqid__WEBPACK_IMPORTED_MODULE_1__),useFileUpload=function useFileUpload(_ref){var fileField=_ref.fileField,upload=_ref.upload,download=_ref.download,name=_ref.name,id=_ref.id,value=_ref.value,onChange=_ref.onChange,_ref$convertFilesToBa=_ref.convertFilesToBase64,convertFilesToBase64=void 0===_ref$convertFilesToBa||_ref$convertFilesToBa,_useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(value||[]),_useState2=(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_useState,2),files=_useState2[0],setFiles=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),_useState4=(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_useState3,2),duplicateFileSelections=_useState4[0],setDuplicateFileSelections=_useState4[1],isInitialMount=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(!0),onChangeRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(onChange),downloadRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(download),uploadRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(upload),filesRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(files);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){isInitialMount.current=!1,onChangeRef.current=onChange,downloadRef.current=download,uploadRef.current=upload,filesRef.current=files}),[download,files,onChange,upload]);var getLoadableFilesRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)((function(files){return files.map((function(file){var loadableFile=(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},file),originalFile=file.originalFile,id=file.id,extraParams=file.extraParams,upload=uploadRef.current;if(upload){var retryFileUpload=function retryFileUpload(){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref2){return _ref2.originalFile===originalFile}));return stateFile?(stateFile.uploadError="",delete stateFile.retryUpload,Object.assign(stateFile,uploadFile()),(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},uploadFile=function uploadFile(){var cancel=upload(originalFile,{onProgress:function onProgress(progress){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref3){return _ref3.originalFile===originalFile}));return stateFile?(stateFile.uploadProgress=progress,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},onError:function onError(err){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref4){return _ref4.originalFile===originalFile}));return stateFile?(stateFile.uploadError=err.message,stateFile.retryUpload=retryFileUpload,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},onSuccess:function onSuccess(payload){payload.id&&setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref5){return _ref5.originalFile===originalFile}));return stateFile?(stateFile.id=payload.id,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},onComplete:function onComplete(){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref6){return _ref6.originalFile===originalFile}));return stateFile?(stateFile.uploading=!1,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))}}).cancel;setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref7){return _ref7.originalFile===originalFile}));return stateFile?(stateFile.uploading=!0,stateFile.cancelUpload=function(){cancel(),setFiles((function(prevFiles){return prevFiles.includes(stateFile)?(prevFiles.splice(prevFiles.indexOf(stateFile),1),(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))};loadableFile.upload=uploadFile}var download=downloadRef.current;if(download){var retryFileDownload=function retryFileDownload(){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref8){return _ref8.id===id}));return stateFile?(stateFile.downloadError="",delete stateFile.retryDownload,Object.assign(stateFile,downloadFile()),(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},downloadFile=function downloadFile(){var cancel=download({id:id,extraParams:extraParams},{onProgress:function onProgress(progress){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref9){return _ref9.id===id}));return stateFile?(stateFile.downloadProgress=progress,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},onError:function onError(err){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref10){return _ref10.id===id}));return stateFile?(stateFile.downloadError=err.message,stateFile.retryDownload=retryFileDownload,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},onSuccess:function onSuccess(payload){payload.id&&setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref11){return _ref11.id===id}));return stateFile?(stateFile.id=payload.id,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},onComplete:function onComplete(){setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref12){return _ref12.id===id}));return stateFile?(stateFile.downloading=!1,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))}}).cancel;setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref13){return _ref13.id===id}));return stateFile?(stateFile.downloading=!0,stateFile.cancelDownload=function(){cancel(),setFiles((function(prevFiles){var stateFile=prevFiles.find((function(_ref14){return _ref14.id===id}));return stateFile?(stateFile.downloading=!1,delete stateFile.downloadError,delete stateFile.downloadProgress,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))},(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(prevFiles)):prevFiles}))};loadableFile.download=downloadFile}return loadableFile}))}));return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){if(fileField){var changeEventCallback=function(){var _ref15=(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_6__.Z)().mark((function _callee(){var _reduce,_reduce2,selectedFiles,_duplicateFileSelections,newFiles,newLoadableFiles,nextFiles;return(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_6__.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(fileField.files&&fileField.files.length>0)){_context.next=11;break}return _reduce=(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(fileField.files).reduce((function(accumulator,file){var existingFile=filesRef.current.find((function(_ref16){var name=_ref16.name,size=_ref16.size;return file.name===name&&file.size===size}));return existingFile?accumulator[1].push(filesRef.current.indexOf(existingFile)):accumulator[0].push(file),accumulator}),[[],[]]),_reduce2=(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_reduce,2),selectedFiles=_reduce2[0],_duplicateFileSelections=_reduce2[1],_context.next=4,Promise.all(selectedFiles.map((function(file){var name=file.name,size=file.size;return convertFilesToBase64?new Promise((function(resolve,reject){var reader=new FileReader;reader.readAsDataURL(file),reader.onload=function(){return resolve({base64:reader.result,originalFile:file,name:name,size:size})},reader.onerror=function(error){return reject(error)}})):{originalFile:file,id:uniqid__WEBPACK_IMPORTED_MODULE_1___default()(),name:name,size:size}})));case 4:newFiles=_context.sent,fileField.value="",newLoadableFiles=getLoadableFilesRef.current(newFiles),nextFiles=[].concat((0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(filesRef.current),(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(newLoadableFiles)),setFiles(nextFiles),setDuplicateFileSelections(_duplicateFileSelections),newLoadableFiles.forEach((function(_ref17){var upload=_ref17.upload;upload&&upload()}));case 11:case"end":return _context.stop()}}),_callee)})));return function changeEventCallback(){return _ref15.apply(this,arguments)}}();return fileField.addEventListener("change",changeEventCallback),function(){fileField.removeEventListener("change",changeEventCallback)}}}),[convertFilesToBase64,fileField]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){setFiles((function(prevFiles){return value&&JSON.stringify(value.map((function(_ref18){return{id:_ref18.id,name:_ref18.name,size:_ref18.size}})))!==JSON.stringify(prevFiles.map((function(_ref19){return{id:_ref19.id,name:_ref19.name,size:_ref19.size}})))?value:prevFiles}))}),[value]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){if(onChangeRef.current&&!isInitialMount.current){var event=new Event("change",{bubbles:!0});Object.defineProperty(event,"target",{writable:!1,value:{id:id,name:name,value:files.map((function(_ref20){return{id:_ref20.id,base64:_ref20.base64,name:_ref20.name,size:_ref20.size,originalFile:_ref20.originalFile,extraParams:_ref20.extraParams}}))}}),onChangeRef.current(event)}}),[files,id,name]),{files:files,duplicateFileSelections:duplicateFileSelections,setFiles:setFiles}}},"./src/utils/page.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{N:function(){return flickerElement}});var flickerElement=function flickerElement(element){element.classList.add("flicker"),setTimeout((function(){return element.classList.remove("flicker")}),1e3)}}}]);