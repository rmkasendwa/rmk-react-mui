(self.webpackChunk_infinite_debugger_react_mui=self.webpackChunk_infinite_debugger_react_mui||[]).push([[9592],{"./src/contexts/LocalStorageDataContext.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{GB:function(){return useLocalStorageData}});var D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_infinite_debugger_rmk_utils_data__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@infinite-debugger/rmk-utils/data.js"),_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@infinite-debugger/rmk-utils/StorageManager.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),dataKeys=(__webpack_require__("./node_modules/react/jsx-runtime.js"),_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.get("".concat("cached-data","-keys"))||[]),baseData=_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.get("data")||{};dataKeys.forEach((function(key){var keyData=_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.get("".concat("cached-data","-").concat(key));keyData&&Object.assign(baseData,(0,D_sandbox_rmkasendwa_com_rmk_react_mui_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_4__.Z)({},key,keyData))}));var updateData=function updateData(data){Object.assign(baseData,data);var memorySize=(0,_infinite_debugger_rmk_utils_data__WEBPACK_IMPORTED_MODULE_0__.Bl)(data);if(data&&"number"==typeof memorySize&&memorySize<=15360){if(Object.keys(data).forEach((function(key){_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.add("".concat("cached-data","-").concat(key),data[key]),dataKeys.includes(key)&&dataKeys.splice(dataKeys.indexOf(key),1),dataKeys.push(key)})),dataKeys.length>35)dataKeys.splice(0,dataKeys.length-35).forEach((function(key){_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.remove("".concat("cached-data","-").concat(key))}));_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.add("".concat("cached-data","-keys"),dataKeys)}return baseData},reset=function reset(){dataKeys.forEach((function(key){_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.remove("".concat("cached-data","-").concat(key))})),_infinite_debugger_rmk_utils_StorageManager__WEBPACK_IMPORTED_MODULE_1__.Z.remove("".concat("cached-data","-keys")),dataKeys.splice(0),Object.keys(baseData).forEach((function(key){delete baseData[key]}))},LocalStorageDataContext=(0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)({data:baseData,updateData:updateData,reset:reset}),LocalStorageDataProvider=function LocalStorageDataProvider(_ref){var children=_ref.children,updateLocalData=useCallback((function(data){updateData(data)}),[]),localReset=useCallback((function(){reset()}),[]);return _jsx(LocalStorageDataContext.Provider,{value:{data:baseData,updateData:updateLocalData,reset:localReset},children:children})},useLocalStorageData=function useLocalStorageData(){return(0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(LocalStorageDataContext)};try{LocalStorageDataProvider.displayName="LocalStorageDataProvider",LocalStorageDataProvider.__docgenInfo={description:"",displayName:"LocalStorageDataProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/contexts/LocalStorageDataContext.tsx#LocalStorageDataProvider"]={docgenInfo:LocalStorageDataProvider.__docgenInfo,name:"LocalStorageDataProvider",path:"src/contexts/LocalStorageDataContext.tsx#LocalStorageDataProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/hooks/DataFetching/index.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{jC:function(){return useCacheableData},RO:function(){return useCreate},R2:function(){return useDelete},Db:function(){return useMutation},vc:function(){return usePaginatedRecords},a:function(){return Record_useRecord},PQ:function(){return useUpdate}});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),constants=__webpack_require__("./src/constants.ts"),APIContext=__webpack_require__("./src/contexts/APIContext.tsx"),LocalStorageDataContext=__webpack_require__("./src/contexts/LocalStorageDataContext.tsx"),useAPIService=function useAPIService(defaultValue){var loadOnMount=arguments.length>1&&void 0!==arguments[1]&&arguments[1],cacheKey=arguments.length>2?arguments[2]:void 0,isComponentMountedRef=(0,react.useRef)(!0),_useLocalStorageData=(0,LocalStorageDataContext.GB)(),data=_useLocalStorageData.data,updateData=_useLocalStorageData.updateData;null==defaultValue&&cacheKey&&data[cacheKey]&&(defaultValue=data[cacheKey]);var _useAPIContext=(0,APIContext.gi)(),call=_useAPIContext.call,_useState=(0,react.useState)(defaultValue),_useState2=(0,slicedToArray.Z)(_useState,2),record=_useState2[0],setRecord=_useState2[1],_useState3=(0,react.useState)(!1),_useState4=(0,slicedToArray.Z)(_useState3,2),loaded=_useState4[0],setLoaded=_useState4[1],_useState5=(0,react.useState)(loadOnMount),_useState6=(0,slicedToArray.Z)(_useState5,2),loading=_useState6[0],setLoading=_useState6[1],_useState7=(0,react.useState)(""),_useState8=(0,slicedToArray.Z)(_useState7,2),errorMessage=_useState8[0],setErrorMessage=_useState8[1],load=(0,react.useCallback)(function(){var _ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(apiFunction){var polling,response,_args2=arguments;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(polling=_args2.length>1&&void 0!==_args2[1]&&_args2[1],!apiFunction){_context2.next=11;break}return setErrorMessage(""),setLoaded(!1),setLoading(!0),_context2.next=7,call(apiFunction).then(function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(payload){var response;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,payload;case 2:return response=_context.sent,isComponentMountedRef.current&&(setRecord(response),setLoaded(!0)),_context.abrupt("return",payload);case 5:case"end":return _context.stop()}}),_callee)})));return function(_x2){return _ref2.apply(this,arguments)}}()).catch((function(err){String(err.message).match(constants.Oj)||polling||setErrorMessage(err.message)}));case 7:return response=_context2.sent,isComponentMountedRef.current&&setLoading(!1),cacheKey&&response&&updateData((0,defineProperty.Z)({},cacheKey,response)),_context2.abrupt("return",response);case 11:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref.apply(this,arguments)}}(),[cacheKey,call,updateData]),resetRef=(0,react.useRef)((function(){setRecord(defaultValue),setLoaded(!1),setLoading(loadOnMount),setErrorMessage("")}));return(0,react.useEffect)((function(){return isComponentMountedRef.current=!0,function(){isComponentMountedRef.current=!1}}),[]),{errorMessage:errorMessage,setErrorMessage:setErrorMessage,load:load,loaded:loaded,loading:loading,record:record,setLoaded:setLoaded,setRecord:setRecord,reset:resetRef.current}},objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),_excluded=["load","loading","record","loaded","setLoaded"],useMutation=function useMutation(mutateFunction){var _useAPIService=useAPIService(null),baseMutate=_useAPIService.load,mutating=_useAPIService.loading,mutatedRecord=_useAPIService.record,mutated=_useAPIService.loaded,setMutated=_useAPIService.setLoaded,rest=(0,objectWithoutProperties.Z)(_useAPIService,_excluded),inputMutateRef=(0,react.useRef)(mutateFunction);inputMutateRef.current=mutateFunction;var mutate=(0,react.useCallback)((function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return baseMutate((function(){return inputMutateRef.current.apply(inputMutateRef,args)}))}),[baseMutate]);return(0,objectSpread2.Z)({mutate:mutate,mutating:mutating,mutated:mutated,setMutated:setMutated,mutatedRecord:mutatedRecord},rest)},Create_excluded=["mutate","mutating","mutated","setMutated","mutatedRecord"],useCreate=function useCreate(createFunction){var _useMutation=useMutation(createFunction),create=_useMutation.mutate,creating=_useMutation.mutating,created=_useMutation.mutated,setCreated=_useMutation.setMutated,createdRecord=_useMutation.mutatedRecord,rest=(0,objectWithoutProperties.Z)(_useMutation,Create_excluded);return(0,objectSpread2.Z)({create:create,creating:creating,created:created,setCreated:setCreated,createdRecord:createdRecord},rest)},Update_excluded=["mutate","mutating","mutated","setMutated","mutatedRecord"],useUpdate=function useUpdate(updateFunction){var _useMutation=useMutation(updateFunction),update=_useMutation.mutate,updating=_useMutation.mutating,updated=_useMutation.mutated,setUpdated=_useMutation.setMutated,updatedRecord=_useMutation.mutatedRecord,rest=(0,objectWithoutProperties.Z)(_useMutation,Update_excluded);return(0,objectSpread2.Z)({update:update,updating:updating,updated:updated,updatedRecord:updatedRecord,setUpdated:setUpdated},rest)},Delete_excluded=["mutate","mutating","mutated","setMutated","mutatedRecord"],useDelete=function useDelete(deleteFunction){var _useMutation=useMutation(deleteFunction),_delete=_useMutation.mutate,deleting=_useMutation.mutating,deleted=_useMutation.mutated,setDeleted=_useMutation.setMutated,deletedRecord=_useMutation.mutatedRecord,rest=(0,objectWithoutProperties.Z)(_useMutation,Delete_excluded);return(0,objectSpread2.Z)({_delete:_delete,deleting:deleting,deleted:deleted,setDeleted:setDeleted,deletedRecord:deletedRecord},rest)},esm=__webpack_require__("./node_modules/hash-it/dist/esm/index.mjs"),Record_excluded=["load","loading","errorMessage","record","setRecord"],Record_useRecord=function useRecord(recordFinder){var inProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},defaultValue=inProps.defaultValue,_inProps$loadOnMount=inProps.loadOnMount,loadOnMount=void 0===_inProps$loadOnMount||_inProps$loadOnMount,revalidationKey=inProps.revalidationKey,isInitialMountRef=(0,react.useRef)(!0),recordFinderRef=(0,react.useRef)(recordFinder);recordFinderRef.current=recordFinder;var _useAPIService=useAPIService(defaultValue,loadOnMount,String((0,esm.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},inProps),{},{recordFinder:recordFinder})))),baseLoad=_useAPIService.load,loading=_useAPIService.loading,errorMessage=_useAPIService.errorMessage,record=_useAPIService.record,setRecord=_useAPIService.setRecord,rest=(0,objectWithoutProperties.Z)(_useAPIService,Record_excluded),load=(0,react.useCallback)((function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return baseLoad((function(){return recordFinderRef.current?recordFinderRef.current.apply(recordFinderRef,args):Promise.resolve()}))}),[baseLoad]);return(0,react.useEffect)((function(){loadOnMount&&isInitialMountRef.current&&load()}),[load,loadOnMount]),(0,react.useEffect)((function(){!isInitialMountRef.current&&revalidationKey&&load()}),[load,revalidationKey]),(0,react.useEffect)((function(){return isInitialMountRef.current=!1,function(){isInitialMountRef.current=!0}}),[]),(0,objectSpread2.Z)({load:load,loading:loading,errorMessage:errorMessage,record:null!=record?record:null,setRecord:setRecord},rest)},CacheableData_excluded=["load","loading","errorMessage","record","setRecord","reset"],useCacheableData=function useCacheableData(recordFinder){var inProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},defaultValue=inProps.defaultValue,_inProps$loadOnMount=inProps.loadOnMount,loadOnMount=void 0===_inProps$loadOnMount||_inProps$loadOnMount,revalidationKey=inProps.revalidationKey,_inProps$resetStateOn=inProps.resetStateOnRevalidation,resetStateOnRevalidation=void 0!==_inProps$resetStateOn&&_inProps$resetStateOn,_inProps$autoSync=inProps.autoSync,autoSync=void 0===_inProps$autoSync||_inProps$autoSync,isInitialMountRef=(0,react.useRef)(!0),recordFinderRef=(0,react.useRef)(recordFinder);recordFinderRef.current=recordFinder;var pendingDataRequestControllerRef=(0,react.useRef)(null),_useAPIService=useAPIService(defaultValue,loadOnMount,String((0,esm.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},inProps),{},{recordFinder:String(recordFinder)})))),baseLoad=_useAPIService.load,loading=_useAPIService.loading,errorMessage=_useAPIService.errorMessage,record=_useAPIService.record,setRecord=_useAPIService.setRecord,reset=_useAPIService.reset,rest=(0,objectWithoutProperties.Z)(_useAPIService,CacheableData_excluded),load=(0,react.useCallback)((function(){return baseLoad((0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!recordFinderRef.current){_context.next=3;break}return pendingDataRequestControllerRef.current&&(pendingDataRequestControllerRef.current.cancelRequest(),pendingDataRequestControllerRef.current=null),_context.abrupt("return",recordFinderRef.current({getRequestController:function getRequestController(requestController){pendingDataRequestControllerRef.current=requestController},getStaleWhileRevalidate:function getStaleWhileRevalidate(data){setRecord(data)}}).finally((function(){pendingDataRequestControllerRef.current=null})));case 3:case"end":return _context.stop()}}),_callee)}))))}),[baseLoad,setRecord]);return(0,react.useEffect)((function(){loadOnMount&&isInitialMountRef.current&&load()}),[load,loadOnMount]),(0,react.useEffect)((function(){!isInitialMountRef.current&&revalidationKey&&(resetStateOnRevalidation&&reset(),autoSync&&load())}),[autoSync,load,reset,resetStateOnRevalidation,revalidationKey]),(0,react.useEffect)((function(){return isInitialMountRef.current=!1,function(){isInitialMountRef.current=!0}}),[]),(0,objectSpread2.Z)({load:load,loading:loading,errorMessage:errorMessage,data:record,setData:setRecord,reset:reset},rest)},toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),omit=__webpack_require__("./node_modules/lodash/omit.js"),omit_default=__webpack_require__.n(omit),usePolling=function usePolling(_ref){var autoSync=_ref.autoSync,errorMessage=_ref.errorMessage,loading=_ref.loading,refreshInterval=_ref.refreshInterval,load=_ref.load,nextSyncTimeoutRef=(0,react.useRef)(null),loadRef=(0,react.useRef)(load);loadRef.current=load,(0,react.useEffect)((function(){if(autoSync&&refreshInterval&&refreshInterval>=1e4&&!loading&&!errorMessage){var blurTime,mouseMoveEventCallback=function mouseMoveEventCallback(){null!==nextSyncTimeoutRef.current&&clearTimeout(nextSyncTimeoutRef.current),nextSyncTimeoutRef.current=setTimeout((function(){loadRef.current()}),refreshInterval)},visiblityChangeEventCallback=function visiblityChangeEventCallback(event){null!==nextSyncTimeoutRef.current&&clearTimeout(nextSyncTimeoutRef.current),window.removeEventListener("mousemove",mouseMoveEventCallback),document.hidden?blurTime=Date.now():(window.addEventListener("mousemove",mouseMoveEventCallback),mouseMoveEventCallback(),event&&null!=blurTime&&Date.now()-blurTime>=6e4&&loadRef.current())};return document.addEventListener("visibilitychange",visiblityChangeEventCallback),visiblityChangeEventCallback(),function(){window.removeEventListener("mousemove",mouseMoveEventCallback),document.removeEventListener("visibilitychange",visiblityChangeEventCallback),null!==nextSyncTimeoutRef.current&&clearTimeout(nextSyncTimeoutRef.current)}}}),[autoSync,errorMessage,loading,refreshInterval])},PaginatedRecords_excluded=["load","loading","record","reset","errorMessage","setRecord"],usePaginatedRecords=function usePaginatedRecords(recordFinder){var inProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_inProps$loadOnMount=inProps.loadOnMount,loadOnMount=void 0===_inProps$loadOnMount||_inProps$loadOnMount,_inProps$limit=inProps.limit,limit=void 0===_inProps$limit?100:_inProps$limit,_inProps$offset=inProps.offset,offset=void 0===_inProps$offset?0:_inProps$offset,searchTerm=inProps.searchTerm,loadedPagesMap=inProps.loadedPagesMap,revalidationKey=inProps.revalidationKey,_inProps$autoSync=inProps.autoSync,autoSync=void 0===_inProps$autoSync||_inProps$autoSync,_inProps$canLoadNextP=inProps.canLoadNextPage,canLoadNextPage=void 0===_inProps$canLoadNextP||_inProps$canLoadNextP,refreshInterval=inProps.refreshInterval,_useAPIService=useAPIService(null,loadOnMount),loadFromAPIService=_useAPIService.load,loading=_useAPIService.loading,responseData=_useAPIService.record,errorMessage=(_useAPIService.reset,_useAPIService.errorMessage),setRecord=_useAPIService.setRecord,rest=(0,objectWithoutProperties.Z)(_useAPIService,PaginatedRecords_excluded),cacheKey=String((0,esm.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},omit_default()(inProps,"loadedPagesMap")),{},{recordFinder:recordFinder}))),_useLocalStorageData=(0,LocalStorageDataContext.GB)(),data=_useLocalStorageData.data,updateData=_useLocalStorageData.updateData,cachedLoadedPagesRef=(0,react.useRef)(data[cacheKey]),isInitialMountRef=(0,react.useRef)(!0),pendingRecordRequestControllers=(0,react.useRef)([]),recordFinderRef=(0,react.useRef)(recordFinder);recordFinderRef.current=recordFinder;var loadedPagesMapRef=(0,react.useRef)(loadedPagesMap);loadedPagesMapRef.current=loadedPagesMap;var recordsTotalCountRef=(0,react.useRef)(0),hasNextPageRef=(0,react.useRef)(!0),limitRef=(0,react.useRef)(limit);limitRef.current=limit;var offsetRef=(0,react.useRef)(offset);offsetRef.current=offset;var searchTermRef=(0,react.useRef)(searchTerm);searchTermRef.current=searchTerm;var loadedPages=(0,react.useMemo)((function(){if(loadedPagesMapRef.current)return loadedPagesMapRef.current;var loadedPagesMap=new Map;return cachedLoadedPagesRef.current&&cachedLoadedPagesRef.current.forEach((function(cachedLoadedPage){loadedPagesMap.set(cachedLoadedPage.key,cachedLoadedPage.value)})),loadedPagesMap}),[]),allPageRecordsRef=(0,react.useRef)(isInitialMountRef.current?(0,toConsumableArray.Z)(loadedPages.keys()).sort((function(a,b){return a-b})).map((function(key){return loadedPages.get(key)})).flat():[]),lastLoadedPageRef=(0,react.useRef)(void 0),load=(0,react.useCallback)((function(){var _params$isLoadingNext,params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(params=(0,objectSpread2.Z)({},params)).offset||(params.offset=offsetRef.current),params.limit||(params.limit=limitRef.current),params.searchTerm||(params.searchTerm=searchTermRef.current),null!==(_params$isLoadingNext=params.isLoadingNextPage)&&void 0!==_params$isLoadingNext||(params.isLoadingNextPage=!1),params.isLoadingNextPage||(lastLoadedPageRef.current=void 0),loadFromAPIService((0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){var localPendingRecordRequestControllers,processResponseData,responseData;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return localPendingRecordRequestControllers=[],processResponseData=function processResponseData(responseData){var isResponsePaginated="records"in responseData&&null!=responseData.recordsTotalCount,paginatedResponseData=Array.isArray(responseData)?{records:responseData,recordsTotalCount:responseData.length,hasNextPage:!1,loadedPageKey:0}:null==responseData.recordsTotalCount?(0,objectSpread2.Z)((0,objectSpread2.Z)({},responseData),{},{hasNextPage:!1,loadedPageKey:0}):responseData,records=paginatedResponseData.records,recordsTotalCount=paginatedResponseData.recordsTotalCount,hasNextPage=paginatedResponseData.hasNextPage,loadedPageKey=paginatedResponseData.loadedPageKey;isResponsePaginated||loadedPages.clear(),loadedPages.set(null!=loadedPageKey?loadedPageKey:params.offset,records),allPageRecordsRef.current=(0,toConsumableArray.Z)(loadedPages.keys()).sort((function(a,b){return a-b})).map((function(key){return loadedPages.get(key)})).flat(),lastLoadedPageRef.current=paginatedResponseData,recordsTotalCountRef.current=null!=recordsTotalCount?recordsTotalCount:records.length,hasNextPageRef.current=null!=hasNextPage?hasNextPage:isResponsePaginated&&allPageRecordsRef.current.length<recordsTotalCountRef.current,setRecord(paginatedResponseData),updateData((0,defineProperty.Z)({},cacheKey,(0,toConsumableArray.Z)(loadedPages.entries()).map((function(_ref2){var _ref3=(0,slicedToArray.Z)(_ref2,2);return{key:_ref3[0],value:_ref3[1]}}))))},_context.next=4,recordFinderRef.current((0,objectSpread2.Z)((0,objectSpread2.Z)({},params),{},{getRequestController:function getRequestController(requestController){localPendingRecordRequestControllers.push(requestController),pendingRecordRequestControllers.current.push(requestController)},getStaleWhileRevalidate:function getStaleWhileRevalidate(data){processResponseData(data)},lastLoadedPage:lastLoadedPageRef.current})).finally((function(){localPendingRecordRequestControllers.length>0&&localPendingRecordRequestControllers.forEach((function(requestController){pendingRecordRequestControllers.current.indexOf(requestController)&&pendingRecordRequestControllers.current.splice(pendingRecordRequestControllers.current.indexOf(requestController),1)}))}));case 4:return responseData=_context.sent,params.isLoadingNextPage||(loadedPages.clear(),recordsTotalCountRef.current=0),processResponseData(responseData),_context.abrupt("return",responseData);case 8:case"end":return _context.stop()}}),_callee)}))))}),[cacheKey,loadFromAPIService,loadedPages,setRecord,updateData]),loadRef=(0,react.useRef)(load);loadRef.current=load;var loadNextPage=(0,react.useCallback)((function(params){if(canLoadNextPage&&!loading&&hasNextPageRef.current){var lastPageOffset=(0,toConsumableArray.Z)(loadedPages.keys()).sort((function(a,b){return b-a}))[0],lastPageRecords=loadedPages.get(lastPageOffset);lastPageRecords&&null!=lastPageOffset&&load((0,objectSpread2.Z)((0,objectSpread2.Z)({},params),{},{offset:lastPageOffset+lastPageRecords.length,limit:limit||lastPageRecords.length,isLoadingNextPage:!0}))}}),[canLoadNextPage,limit,load,loadedPages,loading]),resetRef=(0,react.useRef)((function(){loadedPages.clear(),recordsTotalCountRef.current=0,hasNextPageRef.current=!0,lastLoadedPageRef.current=void 0;var requestControllersToClear=(0,toConsumableArray.Z)(pendingRecordRequestControllers.current);requestControllersToClear.forEach((function(pendingRecordRequestController){pendingRecordRequestController.cancelRequest()})),requestControllersToClear.forEach((function(pendingRecordRequestController){pendingRecordRequestControllers.current.includes(pendingRecordRequestController)&&pendingRecordRequestControllers.current.splice(pendingRecordRequestControllers.current.indexOf(pendingRecordRequestController),1)}))}));return(0,react.useEffect)((function(){!isInitialMountRef.current&&(limit||searchTerm||revalidationKey)&&resetRef.current()}),[limit,revalidationKey,searchTerm]),(0,react.useEffect)((function(){loadOnMount&&isInitialMountRef.current&&loadRef.current()}),[loadOnMount]),(0,react.useEffect)((function(){!isInitialMountRef.current&&autoSync&&(limit||searchTerm||offset||revalidationKey)&&loadRef.current()}),[autoSync,limit,offset,revalidationKey,searchTerm]),usePolling({load:load,autoSync:autoSync,errorMessage:errorMessage,loading:loading,refreshInterval:refreshInterval}),(0,react.useEffect)((function(){return isInitialMountRef.current=!1,function(){isInitialMountRef.current=!0}}),[]),(0,objectSpread2.Z)({currentPageRecords:loadedPages.get(offset)||[],allPageRecords:allPageRecordsRef.current,recordsTotalCount:recordsTotalCountRef.current,loadedPages:loadedPages,load:load,loading:loading,loadNextPage:loadNextPage,responseData:responseData,reset:resetRef.current,hasNextPage:hasNextPageRef.current,errorMessage:errorMessage},rest)}},"?9157":function(){}}]);